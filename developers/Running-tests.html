<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unit Tests &mdash; OpenTera 1.2.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=010db75e"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Translations" href="Translations.html" />
    <link rel="prev" title="Services Access Roles" href="../services/Services-Access.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            OpenTera
              <img src="../_static/LogoOpenTera200px.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.2.6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Home.html">About OpenTera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Architecture-Overview.html">OpenTera Architecture Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Security.html">Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Deployment.html">Deployment Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/DeployWithDockerCompose.html">Deploying with Docker on Linux Servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/DeployWithLinuxNative.html">Deploying OpenTera on a Linux Server</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Services and Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../services/OpenTera_Services.html">OpenTera Services Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/services.html">Core Services</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Developers.html">Developers setup guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Code-Structure.html">Code structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="Service-Creation.html">Creating a new service</a></li>
<li class="toctree-l1"><a class="reference internal" href="Database-Structure.html">Database Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="Form-Structure.html">Internal Form Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="Messages-structure.html">Internal messages structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="Internal-services-communication-module.html">Inter-service communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="Login-and-authentication.html">Login &amp; Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/Services-Access.html">Services Access Roles</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Unit Tests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#self-contained-environment">Self-contained environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-unit-tests">Creating unit tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-unit-tests">Running unit tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#manual-testing">Manual testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatic-testing-on-pull-requests">Automatic testing on pull requests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Translations.html">Translations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Websockets-communication.html">Websockets communication</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenTera</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Unit Tests</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/developers/Running-tests.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="unit-tests">
<h1>Unit Tests<a class="headerlink" href="#unit-tests" title="Link to this heading"></a></h1>
<p>OpenTera aims to deploy robust and tested releases. To do so, unit tests are designed to test the various components of
the system, such as <a class="reference internal" href="Database-Structure.html"><span class="doc std std-doc">database models</span></a> and various <a class="reference internal" href="../services/teraserver/api/API.html"><span class="doc std std-doc">APIs</span></a>.</p>
<p>Tests are based on <a class="reference external" href="https://www.pytest.org">PyTest</a> and <a class="reference external" href="https://docs.python.org/3/library/unittest.html">unittest</a> and
are located in the <a class="reference external" href="https://github.com/introlab/opentera/tree/main/teraserver/python/tests">tests folder</a> of the project.</p>
<p>While it’s hard to develop tests that cover every situation, effort is being put into each new features and releases to
ensure that features are tested before being deployed on a production server.</p>
<section id="self-contained-environment">
<h2>Self-contained environment<a class="headerlink" href="#self-contained-environment" title="Link to this heading"></a></h2>
<p>Unit tests are designed to run even if the server itself is not running. By creating a local
<a class="reference external" href="https://flask.palletsprojects.com">Flask</a> component to serve the OpenTera API and using a local
<a class="reference external" href="https://www.sqlite.org">SqlLite database</a>, tests are self-contained and do no interact with an actual OpenTera server
instance. However, a <a class="reference external" href="https://redis.io/">redis</a> server is still required to run the tests.</p>
<p>More specifically, each test class setups a new database, ensuring that changes made by the tests functions do not
have a larger scope than the class itself, which helps prevent unwanted cross-interactions and tests in another class
that would fail because the database data changed.</p>
</section>
<section id="creating-unit-tests">
<h2>Creating unit tests<a class="headerlink" href="#creating-unit-tests" title="Link to this heading"></a></h2>
<p>Developers are encouraged to develop unit tests while expanding OpenTera core service (and also in their own services,
even if this is beyond the scope of this documentation).</p>
<p>A few guidelines need to be followed while doing so:</p>
<ol class="arabic simple">
<li><p>Each class needs to be self-contained and not depends on external components. If testing API features, the test class
should inherits from the related base test class (such as <code class="docutils literal notranslate"><span class="pre">BaseUserAPITest</span></code> for the user API tests).</p></li>
<li><p>Each test function should ensure that the changed data in the database is set back to its initial
value after performing the test. If, for example, a test deleted some object in the database, they should be recreated
to prevent following tests in the same class to fail. Remember that the data is persistent for the class only - it is
not recreated automatically after each test.</p></li>
<li><p>Always ensure to run the full tests after adding new features or modifying existing ones. Some changes can have
unexpected impacts on other parts of the project, considering the large codebase of the OpenTera server.</p></li>
</ol>
</section>
<section id="running-unit-tests">
<h2>Running unit tests<a class="headerlink" href="#running-unit-tests" title="Link to this heading"></a></h2>
<p>While developing features, it is recommended to run (and update) manual tests once in a while to ensure the quality of
the modifications. An automatic testing feature is also automated on GitHub.</p>
<section id="manual-testing">
<h3>Manual testing<a class="headerlink" href="#manual-testing" title="Link to this heading"></a></h3>
<p>Tests can be manually run simply by running the <code class="docutils literal notranslate"><span class="pre">pytest</span></code> command in a python console, followed by the path containing
the tests to be executed. It is possible to run all the tests with the base <code class="docutils literal notranslate"><span class="pre">tests</span></code> path.</p>
<p>If using <a class="reference external" href="https://www.jetbrains.com/pycharm/">PyCharm IDE</a>, tests can be simply run with the contextual menu (displayed
by right-clicking on a test folder) and selecting the <code class="docutils literal notranslate"><span class="pre">Run</span> <span class="pre">pytest</span> <span class="pre">in...</span></code> option.</p>
</section>
<section id="automatic-testing-on-pull-requests">
<h3>Automatic testing on pull requests<a class="headerlink" href="#automatic-testing-on-pull-requests" title="Link to this heading"></a></h3>
<p>GitHub automation is used to run all the tests on every pull request (and changes made to it). If a pull request does
not successfully run the tests, it will not be merged.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../services/Services-Access.html" class="btn btn-neutral float-left" title="Services Access Roles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Translations.html" class="btn btn-neutral float-right" title="Translations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Simon Brière, Dominic Létourneau.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>