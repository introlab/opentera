!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Translator=e()}(this,(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var a={INVALID_PARAM_LANGUAGE:function(e){return"Invalid parameter for `language` provided. Expected a string, but got ".concat(t(e),".")},INVALID_PARAM_JSON:function(e){return"Invalid parameter for `json` provided. Expected an object, but got ".concat(t(e),".")},EMPTY_PARAM_LANGUAGE:function(){return"The parameter for `language` can't be an empty string."},EMPTY_PARAM_JSON:function(){return"The parameter for `json` must have at least one key/value pair."},INVALID_PARAM_KEY:function(e){return"Invalid parameter for `key` provided. Expected a string, but got ".concat(t(e),".")},NO_LANGUAGE_REGISTERED:function(t){return'No translation for language "'.concat(t,'" has been added, yet. Make sure to register that language using the `.add()` method first.')},TRANSLATION_NOT_FOUND:function(t,e){return'No translation found for key "'.concat(t,'" in language "').concat(e,'". Is there a key/value in your translation file?')},INVALID_PARAMETER_SOURCES:function(e){return"Invalid parameter for `sources` provided. Expected either a string or an array, but got ".concat(t(e),".")},FETCH_ERROR:function(t){return'Could not fetch "'.concat(t.url,'": ').concat(t.status," (").concat(t.statusText,")")},INVALID_ENVIRONMENT:function(){return"You are trying to execute the method `translatePageTo()`, which is only available in the browser. Your environment is most likely Node.js"},MODULE_NOT_FOUND:function(t){return t},MISMATCHING_ATTRIBUTES:function(t,e,n){return'The attributes "data-i18n" and "data-i18n-attr" must contain the same number of keys.\n\nValues in `data-i18n`:      ('.concat(t.length,") `").concat(t.join(" "),"`\nValues in `data-i18n-attr`: (").concat(e.length,") `").concat(e.join(" "),"`\n\nThe HTML element is:\n").concat(n.outerHTML)},INVALID_OPTIONS:function(e){return"Invalid config passed to the `Translator` constructor. Expected an object, but got ".concat(t(e),". Using default config instead.")}};function i(t){return function(e){if(t)try{for(var n=a[e],o=arguments.length,i=new Array(o>1?o-1:0),u=1;u<o;u++)i[u-1]=arguments[u];throw new TypeError(n?n.apply(void 0,i):"Unhandled Error")}catch(t){var s=t.stack.split(/\n/g)[1],c=s.split(/@/),l=r(c,2),g=l[0],f=l[1];console.error("".concat(t.message,"\n\nThis error happened in the method `").concat(g,"` from: `").concat(f,"`.\n\nIf you don't want to see these error messages, turn off debugging by passing `{ debug: false }` to the constructor.\n\nError code: ").concat(e,"\n\nCheck out the documentation for more details about the API:\nhttps://github.com/andreasremdt/simple-translator#usage\n        "))}}}return function(){function r(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(this,r),this.debug=i(!0),("object"!=t(n)||Array.isArray(n))&&(this.debug("INVALID_OPTIONS",n),n={}),this.languages=new Map,this.config=Object.assign(r.defaultConfig,n);var o=this.config,a=o.debug,u=o.registerGlobally,s=o.detectLanguage;this.debug=i(a),u&&(this._globalObject[u]=this.translateForKey.bind(this)),s&&"browser"==this._env&&this._detectLanguage()}var o,a,u;return o=r,a=[{key:"_detectLanguage",value:function(){var t=localStorage.getItem(this.config.persistKey);if(t)this.config.defaultLanguage=t;else{var e=navigator.languages?navigator.languages[0]:navigator.language;this.config.defaultLanguage=e.substr(0,2)}}},{key:"_getValueFromJSON",value:function(t,e){var n=this.languages.get(e);return t.split(".").reduce((function(t,e){return t?t[e]:null}),n)}},{key:"_replace",value:function(t,e){var n,r,o=this,a=null===(n=t.getAttribute("data-i18n"))||void 0===n?void 0:n.split(/\s/g),i=null==t||null===(r=t.getAttribute("data-i18n-attr"))||void 0===r?void 0:r.split(/\s/g);i&&a.length!=i.length&&this.debug("MISMATCHING_ATTRIBUTES",a,i,t),a.forEach((function(n,r){var a=o._getValueFromJSON(n,e),u=i?i[r]:"innerHTML";a?"innerHTML"==u?t[u]=a:t.setAttribute(u,a):o.debug("TRANSLATION_NOT_FOUND",n,e)}))}},{key:"translatePageTo",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.config.defaultLanguage;if("node"!=this._env)if("string"==typeof e)if(0!=e.length)if(this.languages.has(e)){var n="string"==typeof this.config.selector?Array.from(document.querySelectorAll(this.config.selector)):this.config.selector;n.length&&n.length>0?n.forEach((function(n){return t._replace(n,e)})):null==n.length&&this._replace(n,e),this._currentLanguage=e,document.documentElement.lang=e,this.config.persist&&localStorage.setItem(this.config.persistKey,e)}else this.debug("NO_LANGUAGE_REGISTERED",e);else this.debug("EMPTY_PARAM_LANGUAGE");else this.debug("INVALID_PARAM_LANGUAGE",e);else this.debug("INVALID_ENVIRONMENT")}},{key:"translateForKey",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.currentLanguage;if("string"!=typeof t)return this.debug("INVALID_PARAM_KEY",t),null;if(!this.languages.has(e))return this.debug("NO_LANGUAGE_REGISTERED",e),null;var n=this._getValueFromJSON(t,e);return n||(this.debug("TRANSLATION_NOT_FOUND",t,e),null)}},{key:"add",value:function(e,n){return"string"!=typeof e?(this.debug("INVALID_PARAM_LANGUAGE",e),this):0==e.length?(this.debug("EMPTY_PARAM_LANGUAGE"),this):Array.isArray(n)||"object"!=t(n)?(this.debug("INVALID_PARAM_JSON",n),this):0==Object.keys(n).length?(this.debug("EMPTY_PARAM_JSON"),this):(this.languages.set(e,n),this)}},{key:"remove",value:function(t){return"string"!=typeof t?(this.debug("INVALID_PARAM_LANGUAGE",t),this):0==t.length?(this.debug("EMPTY_PARAM_LANGUAGE"),this):(this.languages.delete(t),this)}},{key:"fetch",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Array.isArray(t)&&"string"!=typeof t)return this.debug("INVALID_PARAMETER_SOURCES",t),null;Array.isArray(t)||(t=[t]);var r=t.map((function(t){var n=t.replace(/\.json$/,"").replace(/^\//,""),r=e.config.filesLocation.replace(/\/$/,"");return"".concat(r,"/").concat(n,".json")}));return"browser"==this._env?Promise.all(r.map((function(t){return fetch(t)}))).then((function(t){return Promise.all(t.map((function(t){if(t.ok)return t.json();e.debug("FETCH_ERROR",t)})))})).then((function(r){return r=r.filter((function(t){return t})),n&&r.forEach((function(n,r){e.add(t[r],n)})),r.length>1?r:r[0]})):"node"==this._env?new Promise((function(o){var a=[];r.forEach((function(r,o){try{var i=JSON.parse(require("fs").readFileSync(process.cwd()+r,"utf-8"));n&&e.add(t[o],i),a.push(i)}catch(t){e.debug("MODULE_NOT_FOUND",t.message)}})),o(a.length>1?a:a[0])})):void 0}))},{key:"_globalObject",get:function(){return"browser"==this._env?window:global}},{key:"_env",get:function(){return"undefined"!=typeof window?"browser":"undefined"!=typeof module&&module.exports?"node":"browser"}},{key:"currentLanguage",get:function(){return this._currentLanguage||this.config.defaultLanguage}}],u=[{key:"defaultConfig",get:function(){return{defaultLanguage:"en",detectLanguage:!0,selector:"[data-i18n]",debug:!1,registerGlobally:"__",persist:!1,persistKey:"preferred_language",filesLocation:"/i18n"}}}],a&&n(o.prototype,a),u&&n(o,u),r}()}));
//# sourceMappingURL=translator.min.js.map
